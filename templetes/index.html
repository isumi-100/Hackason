<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>大喜利SNS</title>
  </head>
  <body>
    <h1>大喜利SNS</h1>

    <h2>悩みを投稿</h2>
    <input type="text" id="post" placeholder="悩みを書く" />
    <button onclick="submitPost()">投稿</button>

    <h2>投稿一覧</h2>
    <div id="posts"></div>

    <script>
      async function submitPost() {
        let text = document.getElementById("post").value;
        await fetch("/posts", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text }),
        });
        loadPosts();
      }

      async function loadPosts() {
        let response = await fetch("/posts");
        let posts = await response.json();
        let postsDiv = document.getElementById("posts");
        postsDiv.innerHTML = "";
        posts.forEach((post) => {
          postsDiv.innerHTML += `<p>${post.text} <button onclick="like(${post.id})">いいね</button></p>`;
        });
      }

      loadPosts();
    </script>
  </body>
</html>
